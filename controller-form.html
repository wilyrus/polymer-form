<!--
*
Class what encapsulating all form components
*
-->
<link rel="import" href="facade-form.html">
<link rel="import" href="form-data.html">
<link rel="import" href="form-list.html">
<link rel="import" href="form-form.html">

<dom-module id="controller-form">
    <app-location route="{{route}}"></app-location>
    <app-route route="{{route}}" pattern="/:page" data="{{routeData}}" tail="{{subroute}}"></app-route>
    <template>
        <style is="custom-style">
            .flex-stretch-align {
                @apply(--layout-horizontal);
                height: 100%;
            }

            .flex-stretch-vertical {
                @apply(--layout-vertical);
                height: 100%;
            }

            .dataform,
            .datalist {
                @apply(--layout-flex-1);
            }

            #list {
                --iron-data-table-header: {
                    z-index: 0;
                }
            }
        </style>
        <form-data id="form-data" items="{{items}}" selected="{{selected}}"></form-data>
        <paper-drawer-panel force-narrow>
            <paper-header-panel drawer>
                <paper-toolbar>
                    <div>Change your application</div>
                </paper-toolbar>
                <div>The application list</div>
            </paper-header-panel>
            <paper-header-panel main>
                <paper-toolbar>
                    <paper-icon-button icon="menu" paper-drawer-toggle id='superimp'></paper-icon-button>
                    <div class="middle title">Title</div>
                    <div class="spacer"></div>
                    <paper-icon-button icon="refresh"></paper-icon-button>
                    <paper-icon-button icon="add">+</paper-icon-button>
                    <paper-icon-button icon="content-cut"></paper-icon-button>
                    <paper-icon-button icon="content-copy"></paper-icon-button>
                    <paper-icon-button icon="content-paste"></paper-icon-button>
                    <div class="spacer"></div>
                    <paper-tabs selected="0" scrollable autoselect-delay="300" style="width: 600px;">
                        <paper-tab>Worckflow Scheme</paper-tab>
                        <paper-tab>Fields</paper-tab>
                        <paper-tab>Form</paper-tab>
                        <paper-tab>Security</paper-tab>
                        <paper-tab>E-mail Notifications</paper-tab>
                        <paper-tab>Export Settings</paper-tab>
                        <paper-tab>CSV Import</paper-tab>
                        <paper-tab>Event triggers</paper-tab>
                    </paper-tabs>
                </paper-toolbar>
                <div class="container flex-stretch-align">
                    <form-list class="datalist flex-stretch-vertical" id="list" items='[[items]]' selected='[[selected]]' selectedItem='[[selected]]' style='flex:1;'></form-list>
                    <form-form class="dataform container flex-stretch-vertical" id="form" items='[[items]]' selected='[[selected]]' style='flex:1;'></form-form>
                </div>
            </paper-header-panel>
        </paper-drawer-panel>
    </template>

    <style>
        /* local DOM styles go here */

        :host {
            display: block;
            position: relative;
            min-height: 100vh;
            --app-primary-color: #202020;
            --app-secondary-color: #757575;
            --app-accent-color: #172C50;
            --paper-button-ink-color: var(--app-accent-color);
            --paper-icon-button-ink-color: var(--app-accent-color);
            --paper-spinner-color: var(--app-accent-color);
            -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
            color: var(--app-primary-color);
        }

        #paperDrawerPanel [main] {
            text-align: center;
            background-color: var(--google-grey-100);
        }

        #paperDrawerPanel [drawer] {
            border-right: 1px solid var(--google-grey-300);
        }

        #paperDrawerPanel[right-drawer] [drawer] {
            border-left: 1px solid var(--google-grey-300);
        }

        paper-toolbar paper-progress {
            --paper-progress-active-color: var(--accent-color);
        }

        .spacer {
            @apply(--layout-flex);
        }
    </style>
    </template>
    <script>
        Polymer({
            is: 'controller-form',

            listeners: {
                'items-loaded': '_loadDataToList',
                'change-selection': '_loadDataToForm'
            },

            _loadDataToList: function(event) {
                var items = event.detail.items
                if (items && items.length > 0) {
                    this.$.list.setItems(items)
                }
            },

            _loadDataToForm: function(items) {
                var item = event.detail.item
                debugger
                if (item) {
                    this.$.form.setData(item)
                }
            }
        });
    </script>

</dom-module>
